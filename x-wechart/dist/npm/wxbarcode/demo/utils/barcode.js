function getBytes(t){for(var E=[],r=0;r<t.length;r++)E.push(t.charCodeAt(r));return E}function stringToCode128(t){var E={currcs:CODESET.C},r=getBytes(t),e=r[0]==CHAR_TILDE?1:0,i=r.length>0?codeSetAllowedFor(r[e++]):CODESET.AB,T=r.length>0?codeSetAllowedFor(r[e++]):CODESET.AB;E.currcs=function(t,E){var r=0;return r+=t==CODESET.A?1:0,r+=t==CODESET.B?-1:0,r+=E==CODESET.A?1:0,r+=E==CODESET.B?-1:0,r>0?CODESET.A:CODESET.B}(i,T),E.currcs=function(t,E){for(var r=0;r<t.length;r++){var e=t[r];if((e<48||e>57)&&e!=CHAR_TILDE)return E}return CODESET.C}(r,E.currcs);var C=new Array;switch(E.currcs){case CODESET.A:C.push(SET_STARTA);break;case CODESET.B:C.push(SET_STARTB);break;default:C.push(SET_STARTC)}for(var S=0;S<r.length;S++){var h=r[S];h in REPLACE_CODES&&(C.push(REPLACE_CODES[h]),S++,h=r[S]);var s=r.length>S+1?r[S+1]:-1;C=C.concat(function(t,r,e){var i=[],T=-1;if(charCompatible(t,e))e==CODESET.C&&(-1==r?(T=SET_CODEB,e=CODESET.B):-1==r||charCompatible(r,e)||(charCompatible(r,CODESET.A)?(T=SET_CODEA,e=CODESET.A):(T=SET_CODEB,e=CODESET.B)));else if(-1==r||charCompatible(r,e))T=SET_SHIFT;else switch(e){case CODESET.A:T=SET_CODEB,e=CODESET.B;break;case CODESET.B:T=SET_CODEA,e=CODESET.A}return-1!=T?(i.push(T),i.push(codeValue(r))):e==CODESET.C?i.push(codeValue(t,r)):i.push(codeValue(t)),E.currcs=e,i}(h,s,E.currcs)),E.currcs==CODESET.C&&S++}for(var c=C[0],o=1;o<C.length;o++)c+=o*C[o];return C.push(c%103),C.push(SET_STOP),C}function codeValue(t,E){return void 0===E?t>=32?t-32:t+64:parseInt(String.fromCharCode(t)+String.fromCharCode(E))}function charCompatible(t,E){var r=codeSetAllowedFor(t);return r==CODESET.ANY||(r==CODESET.AB||(r==CODESET.A&&E==CODESET.A||r==CODESET.B&&E==CODESET.B))}function codeSetAllowedFor(t){return t>=48&&t<=57?CODESET.ANY:t>=32&&t<=95?CODESET.AB:t<32?CODESET.A:CODESET.B}var CHAR_TILDE=126,CODE_FNC1=102,SET_STARTA=103,SET_STARTB=104,SET_STARTC=105,SET_SHIFT=98,SET_CODEA=101,SET_CODEB=100,SET_STOP=106,REPLACE_CODES={CHAR_TILDE:CODE_FNC1},CODESET={ANY:1,AB:2,A:3,B:4,C:5};exports.code128=function(t,E,r,e){r=parseInt(r),e=parseInt(e);for(var i=stringToCode128(E),T=new Graphics(t,r,e),C=T.area.width/(11*(i.length-3)+35),S=T.area.left,h=T.area.top,s=0;s<i.length;s++)for(var c=i[s],o=0;o<8;o+=2){var a=PATTERNS[c][o]*C,n=e-h,l=PATTERNS[c][o+1]*C;a>0&&T.fillFgRect(S,h,a,n),S+=a+l}t.draw()};var Graphics=function(t,E,r){this.width=E,this.height=r,this.quiet=Math.round(this.width/40),this.border_size=0,this.padding_width=0,this.area={width:E-2*this.padding_width-2*this.quiet,height:r-2*this.border_size,top:this.border_size-4,left:this.padding_width+this.quiet},this.ctx=t,this.fg="#000000",this.bg="#ffffff",this.fillBgRect(0,0,E,r),this.fillBgRect(0,this.border_size,E,r-2*this.border_size)};Graphics.prototype._fillRect=function(t,E,r,e,i){this.ctx.setFillStyle(i),this.ctx.fillRect(t,E,r,e)},Graphics.prototype.fillFgRect=function(t,E,r,e){this._fillRect(t,E,r,e,this.fg)},Graphics.prototype.fillBgRect=function(t,E,r,e){this._fillRect(t,E,r,e,this.bg)};var PATTERNS=[[2,1,2,2,2,2,0,0],[2,2,2,1,2,2,0,0],[2,2,2,2,2,1,0,0],[1,2,1,2,2,3,0,0],[1,2,1,3,2,2,0,0],[1,3,1,2,2,2,0,0],[1,2,2,2,1,3,0,0],[1,2,2,3,1,2,0,0],[1,3,2,2,1,2,0,0],[2,2,1,2,1,3,0,0],[2,2,1,3,1,2,0,0],[2,3,1,2,1,2,0,0],[1,1,2,2,3,2,0,0],[1,2,2,1,3,2,0,0],[1,2,2,2,3,1,0,0],[1,1,3,2,2,2,0,0],[1,2,3,1,2,2,0,0],[1,2,3,2,2,1,0,0],[2,2,3,2,1,1,0,0],[2,2,1,1,3,2,0,0],[2,2,1,2,3,1,0,0],[2,1,3,2,1,2,0,0],[2,2,3,1,1,2,0,0],[3,1,2,1,3,1,0,0],[3,1,1,2,2,2,0,0],[3,2,1,1,2,2,0,0],[3,2,1,2,2,1,0,0],[3,1,2,2,1,2,0,0],[3,2,2,1,1,2,0,0],[3,2,2,2,1,1,0,0],[2,1,2,1,2,3,0,0],[2,1,2,3,2,1,0,0],[2,3,2,1,2,1,0,0],[1,1,1,3,2,3,0,0],[1,3,1,1,2,3,0,0],[1,3,1,3,2,1,0,0],[1,1,2,3,1,3,0,0],[1,3,2,1,1,3,0,0],[1,3,2,3,1,1,0,0],[2,1,1,3,1,3,0,0],[2,3,1,1,1,3,0,0],[2,3,1,3,1,1,0,0],[1,1,2,1,3,3,0,0],[1,1,2,3,3,1,0,0],[1,3,2,1,3,1,0,0],[1,1,3,1,2,3,0,0],[1,1,3,3,2,1,0,0],[1,3,3,1,2,1,0,0],[3,1,3,1,2,1,0,0],[2,1,1,3,3,1,0,0],[2,3,1,1,3,1,0,0],[2,1,3,1,1,3,0,0],[2,1,3,3,1,1,0,0],[2,1,3,1,3,1,0,0],[3,1,1,1,2,3,0,0],[3,1,1,3,2,1,0,0],[3,3,1,1,2,1,0,0],[3,1,2,1,1,3,0,0],[3,1,2,3,1,1,0,0],[3,3,2,1,1,1,0,0],[3,1,4,1,1,1,0,0],[2,2,1,4,1,1,0,0],[4,3,1,1,1,1,0,0],[1,1,1,2,2,4,0,0],[1,1,1,4,2,2,0,0],[1,2,1,1,2,4,0,0],[1,2,1,4,2,1,0,0],[1,4,1,1,2,2,0,0],[1,4,1,2,2,1,0,0],[1,1,2,2,1,4,0,0],[1,1,2,4,1,2,0,0],[1,2,2,1,1,4,0,0],[1,2,2,4,1,1,0,0],[1,4,2,1,1,2,0,0],[1,4,2,2,1,1,0,0],[2,4,1,2,1,1,0,0],[2,2,1,1,1,4,0,0],[4,1,3,1,1,1,0,0],[2,4,1,1,1,2,0,0],[1,3,4,1,1,1,0,0],[1,1,1,2,4,2,0,0],[1,2,1,1,4,2,0,0],[1,2,1,2,4,1,0,0],[1,1,4,2,1,2,0,0],[1,2,4,1,1,2,0,0],[1,2,4,2,1,1,0,0],[4,1,1,2,1,2,0,0],[4,2,1,1,1,2,0,0],[4,2,1,2,1,1,0,0],[2,1,2,1,4,1,0,0],[2,1,4,1,2,1,0,0],[4,1,2,1,2,1,0,0],[1,1,1,1,4,3,0,0],[1,1,1,3,4,1,0,0],[1,3,1,1,4,1,0,0],[1,1,4,1,1,3,0,0],[1,1,4,3,1,1,0,0],[4,1,1,1,1,3,0,0],[4,1,1,3,1,1,0,0],[1,1,3,1,4,1,0,0],[1,1,4,1,3,1,0,0],[3,1,1,1,4,1,0,0],[4,1,1,1,3,1,0,0],[2,1,1,4,1,2,0,0],[2,1,1,2,1,4,0,0],[2,1,1,2,3,2,0,0],[2,3,3,1,1,1,2,0]];