'use strict';

//CssTokenizer.js
function CssTokenizer() {
  var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var tagStyle = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  this.res = tagStyle;
  this._state = "SPACE";
  this._buffer = style;
  this._sectionStart = 0;
  this._index = 0;
  this._name = '';
  this._content = '';
  this._list = [];
  this._comma = false;
}
CssTokenizer.prototype.SPACE = function (c) {
  if (/[a-zA-Z.#]/.test(c)) {
    this._sectionStart = this._index;
    this._state = "InName";
  } else if (c == '@') this._state = "Ignore1";else if (c == '/') this._state = "BeforeComment";
};
CssTokenizer.prototype.BeforeComment = function (c) {
  if (c == '*') this._state = "InComment";else {
    this._index--;
    this._state = "SPACE";
  }
};
CssTokenizer.prototype.InComment = function (c) {
  if (c == '*') this._state = "AfterComment";
};
CssTokenizer.prototype.AfterComment = function (c) {
  if (c == '/') this._state = "SPACE";else {
    this._index--;
    this._state = "InComment";
  }
};
CssTokenizer.prototype.InName = function (c) {
  if (c == '{') {
    this._list.push(this._buffer.substring(this._sectionStart, this._index));
    this._sectionStart = this._index + 1;
    this._state = "InContent";
  } else if (c == ',') {
    this._list.push(this._buffer.substring(this._sectionStart, this._index));
    this._sectionStart = this._index + 1;
    this._comma = true;
  } else if ((c == '.' || c == '#') && !this._comma) {
    this._buffer = this._buffer.splice(this._index, 1, ' ');
  } else if (/\s/.test(c)) {
    this._name = this._buffer.substring(this._sectionStart, this._index);
    this._state = "NameSpace";
  } else if (/[>:\[]/.test(c)) {
    if (this._list.length) this._state = "IgnoreName";else this._state = "Ignore1";
  } else this._comma = false;
};
CssTokenizer.prototype.NameSpace = function (c) {
  if (c == '{') {
    this._list.push(this._name);
    this._sectionStart = this._index + 1;
    this._state = "InContent";
  } else if (c == ',') {
    this._comma = true;
    this._list.push(this._name);
    this._sectionStart = this._index + 1;
    this._state = "InName";
  } else if (/\S/.test(c)) {
    if (this._comma) {
      this._sectionStart = this._index;
      this._index--;
      this._state = "InName";
    } else if (this._list.length) this._state = "IgnoreName";else this._state = "Ignore1";
  }
};
CssTokenizer.prototype.InContent = function (c) {
  if (c == '}') {
    this._content = this._buffer.substring(this._sectionStart, this._index);
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
      for (var _iterator = this._list[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
        var item = _step.value;

        this.res[item] = (this.res[item] || '') + this._content;
      }
    } catch (err) {
      _didIteratorError = true;
      _iteratorError = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion && _iterator.return) {
          _iterator.return();
        }
      } finally {
        if (_didIteratorError) {
          throw _iteratorError;
        }
      }
    }

    this._list = [];
    this._comma = false;
    this._state = "SPACE";
  }
};
CssTokenizer.prototype.IgnoreName = function (c) {
  if (c == ',') {
    this._sectionStart = this._index + 1;
    this._state = "InName";
  } else if (c == '{') {
    this._sectionStart = this._index + 1;
    this._state = "InContent";
  }
};
CssTokenizer.prototype.Ignore1 = function (c) {
  if (c == ';') {
    this._state = "SPACE";
    this._sectionStart = this._index + 1;
  } else if (c == '{') this._state = "Ignore2";
};
CssTokenizer.prototype.Ignore2 = function (c) {
  if (c == '}') {
    this._state = "SPACE";
    this._sectionStart = this._index + 1;
  } else if (c == '{') this._state = "Ignore3";
};
CssTokenizer.prototype.Ignore3 = function (c) {
  if (c == '}') this._state = "Ignore2";
};
CssTokenizer.prototype.parse = function () {
  for (; this._index < this._buffer.length; this._index++) {
    this[this._state](this._buffer[this._index]);
  }return this.res;
};
module.exports = CssTokenizer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNzc1Rva2VuaXplci5qcyJdLCJuYW1lcyI6WyJDc3NUb2tlbml6ZXIiLCJzdHlsZSIsInRhZ1N0eWxlIiwicmVzIiwiX3N0YXRlIiwiX2J1ZmZlciIsIl9zZWN0aW9uU3RhcnQiLCJfaW5kZXgiLCJfbmFtZSIsIl9jb250ZW50IiwiX2xpc3QiLCJfY29tbWEiLCJwcm90b3R5cGUiLCJTUEFDRSIsImMiLCJ0ZXN0IiwiQmVmb3JlQ29tbWVudCIsIkluQ29tbWVudCIsIkFmdGVyQ29tbWVudCIsIkluTmFtZSIsInB1c2giLCJzdWJzdHJpbmciLCJzcGxpY2UiLCJsZW5ndGgiLCJOYW1lU3BhY2UiLCJJbkNvbnRlbnQiLCJpdGVtIiwiSWdub3JlTmFtZSIsIklnbm9yZTEiLCJJZ25vcmUyIiwiSWdub3JlMyIsInBhcnNlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBLFNBQVNBLFlBQVQsR0FBaUQ7QUFBQSxNQUEzQkMsS0FBMkIsdUVBQW5CLEVBQW1CO0FBQUEsTUFBZkMsUUFBZSx1RUFBSixFQUFJOztBQUMvQyxPQUFLQyxHQUFMLEdBQVdELFFBQVg7QUFDQSxPQUFLRSxNQUFMLEdBQWMsT0FBZDtBQUNBLE9BQUtDLE9BQUwsR0FBZUosS0FBZjtBQUNBLE9BQUtLLGFBQUwsR0FBcUIsQ0FBckI7QUFDQSxPQUFLQyxNQUFMLEdBQWMsQ0FBZDtBQUNBLE9BQUtDLEtBQUwsR0FBYSxFQUFiO0FBQ0EsT0FBS0MsUUFBTCxHQUFnQixFQUFoQjtBQUNBLE9BQUtDLEtBQUwsR0FBYSxFQUFiO0FBQ0EsT0FBS0MsTUFBTCxHQUFjLEtBQWQ7QUFDRDtBQUNEWCxhQUFhWSxTQUFiLENBQXVCQyxLQUF2QixHQUErQixVQUFTQyxDQUFULEVBQVk7QUFDekMsTUFBSSxhQUFhQyxJQUFiLENBQWtCRCxDQUFsQixDQUFKLEVBQTBCO0FBQ3hCLFNBQUtSLGFBQUwsR0FBcUIsS0FBS0MsTUFBMUI7QUFDQSxTQUFLSCxNQUFMLEdBQWMsUUFBZDtB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QyxFQUEwQyxLQUFLaEIsTUFBTCxFQUExQztBQUNFLFNBQUssS0FBS0gsTUFBVixFQUFrQixLQUFLQyxPQUFMLENBQWEsS0FBS0UsTUFBbEIsQ0FBbEI7QUFERixHQUVBLE9BQU8sS0FBS0osR0FBWjtBQUNELENBSkQ7QUFLQTZCLE9BQU9DLE9BQVAsR0FBaUJqQyxZQUFqQiIsImZpbGUiOiJDc3NUb2tlbml6ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL0Nzc1Rva2VuaXplci5qc1xyXG5mdW5jdGlvbiBDc3NUb2tlbml6ZXIoc3R5bGUgPSAnJywgdGFnU3R5bGUgPSB7fSkge1xyXG4gIHRoaXMucmVzID0gdGFnU3R5bGU7XHJcbiAgdGhpcy5fc3RhdGUgPSBcIlNQQUNFXCI7XHJcbiAgdGhpcy5fYnVmZmVyID0gc3R5bGU7XHJcbiAgdGhpcy5fc2VjdGlvblN0YXJ0ID0gMDtcclxuICB0aGlzLl9pbmRleCA9IDA7XHJcbiAgdGhpcy5fbmFtZSA9ICcnO1xyXG4gIHRoaXMuX2NvbnRlbnQgPSAnJztcclxuICB0aGlzLl9saXN0ID0gW107XHJcbiAgdGhpcy5fY29tbWEgPSBmYWxzZTtcclxufVxyXG5Dc3NUb2tlbml6ZXIucHJvdG90eXBlLlNQQUNFID0gZnVuY3Rpb24oYykge1xyXG4gIGlmICgvW2EtekEtWi4jXS8udGVzdChjKSkge1xyXG4gICAgdGhpcy5fc2VjdGlvblN0YXJ0ID0gdGhpcy5faW5kZXg7XHJcbiAgICB0aGlzLl9zdGF0ZSA9IFwiSW5OYW1lXCI7XHJcbiAgfSBlbHNlIGlmIChjID09ICdAJykgdGhpcy5fc3RhdGUgPSBcIklnbm9yZTFcIjtcclxuICBlbHNlIGlmIChjID09ICcvJykgdGhpcy5fc3RhdGUgPSBcIkJlZm9yZUNvbW1lbnRcIjtcclxufTtcclxuQ3NzVG9rZW5pemVyLnByb3RvdHlwZS5CZWZvcmVDb21tZW50ID0gZnVuY3Rpb24oYykge1xyXG4gIGlmIChjID09ICcqJykgdGhpcy5fc3RhdGUgPSBcIkluQ29tbWVudFwiO1xyXG4gIGVsc2Uge1xyXG4gICAgdGhpcy5faW5kZXgtLTtcclxuICAgIHRoaXMuX3N0YXRlID0gXCJTUEFDRVwiO1xyXG4gIH1cclxufTtcclxuQ3NzVG9rZW5pemVyLnByb3RvdHlwZS5JbkNvbW1lbnQgPSBmdW5jdGlvbihjKSB7XHJcbiAgaWYgKGMgPT0gJyonKSB0aGlzLl9zdGF0ZSA9IFwiQWZ0ZXJDb21tZW50XCI7XHJcbn07XHJcbkNzc1Rva2VuaXplci5wcm90b3R5cGUuQWZ0ZXJDb21tZW50ID0gZnVuY3Rpb24oYykge1xyXG4gIGlmIChjID09ICcvJykgdGhpcy5fc3RhdGUgPSBcIlNQQUNFXCI7XHJcbiAgZWxzZSB7XHJcbiAgICB0aGlzLl9pbmRleC0tO1xyXG4gICAgdGhpcy5fc3RhdGUgPSBcIkluQ29tbWVudFwiXHJcbiAgfVxyXG59O1xyXG5Dc3NUb2tlbml6ZXIucHJvdG90eXBlLkluTmFtZSA9IGZ1bmN0aW9uKGMpIHtcclxuICBpZiAoYyA9PSAneycpIHtcclxuICAgIHRoaXMuX2xpc3QucHVzaCh0aGlzLl9idWZmZXIuc3Vic3RyaW5nKHRoaXMuX3NlY3Rpb25TdGFydCwgdGhpcy5faW5kZXgpKVxyXG4gICAgdGhpcy5fc2VjdGlvblN0YXJ0ID0gdGhpcy5faW5kZXggKyAxO1xyXG4gICAgdGhpcy5fc3RhdGUgPSBcIkluQ29udGVudFwiO1xyXG4gIH0gZWxzZSBpZiAoYyA9PSAnLCcpIHtcclxuICAgIHRoaXMuX2xpc3QucHVzaCh0aGlzLl9idWZmZXIuc3Vic3RyaW5nKHRoaXMuX3NlY3Rpb25TdGFydCwgdGhpcy5faW5kZXgpKTtcclxuICAgIHRoaXMuX3NlY3Rpb25TdGFydCA9IHRoaXMuX2luZGV4ICsgMTtcclxuICAgIHRoaXMuX2NvbW1hID0gdHJ1ZTtcclxuICB9IGVsc2UgaWYgKChjID09ICcuJyB8fCBjID09ICcjJykgJiYgIXRoaXMuX2NvbW1hKSB7XHJcbiAgICB0aGlzLl9idWZmZXIgPSB0aGlzLl9idWZmZXIuc3BsaWNlKHRoaXMuX2luZGV4LCAxLCAnICcpO1xyXG4gIH0gZWxzZSBpZiAoL1xccy8udGVzdChjKSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IHRoaXMuX2J1ZmZlci5zdWJzdHJpbmcodGhpcy5fc2VjdGlvblN0YXJ0LCB0aGlzLl9pbmRleCk7XHJcbiAgICB0aGlzLl9zdGF0ZSA9IFwiTmFtZVNwYWNlXCI7XHJcbiAgfSBlbHNlIGlmICgvWz46XFxbXS8udGVzdChjKSkge1xyXG4gICAgaWYgKHRoaXMuX2xpc3QubGVuZ3RoKSB0aGlzLl9zdGF0ZSA9IFwiSWdub3JlTmFtZVwiO1xyXG4gICAgZWxzZSB0aGlzLl9zdGF0ZSA9IFwiSWdub3JlMVwiO1xyXG4gIH0gZWxzZSB0aGlzLl9jb21tYSA9IGZhbHNlO1xyXG59O1xyXG5Dc3NUb2tlbml6ZXIucHJvdG90eXBlLk5hbWVTcGFjZSA9IGZ1bmN0aW9uKGMpIHtcclxuICBpZiAoYyA9PSAneycpIHtcclxuICAgIHRoaXMuX2xpc3QucHVzaCh0aGlzLl9uYW1lKTtcclxuICAgIHRoaXMuX3NlY3Rpb25TdGFydCA9IHRoaXMuX2luZGV4ICsgMTtcclxuICAgIHRoaXMuX3N0YXRlID0gXCJJbkNvbnRlbnRcIjtcclxuICB9IGVsc2UgaWYgKGMgPT0gJywnKSB7XHJcbiAgICB0aGlzLl9jb21tYSA9IHRydWU7XHJcbiAgICB0aGlzLl9saXN0LnB1c2godGhpcy5fbmFtZSk7XHJcbiAgICB0aGlzLl9zZWN0aW9uU3RhcnQgPSB0aGlzLl9pbmRleCArIDE7XHJcbiAgICB0aGlzLl9zdGF0ZSA9IFwiSW5OYW1lXCJcclxuICB9IGVsc2UgaWYgKC9cXFMvLnRlc3QoYykpIHtcclxuICAgIGlmICh0aGlzLl9jb21tYSkge1xyXG4gICAgICB0aGlzLl9zZWN0aW9uU3RhcnQgPSB0aGlzLl9pbmRleDtcclxuICAgICAgdGhpcy5faW5kZXgtLTtcclxuICAgICAgdGhpcy5fc3RhdGUgPSBcIkluTmFtZVwiO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLl9saXN0Lmxlbmd0aCkgdGhpcy5fc3RhdGUgPSBcIklnbm9yZU5hbWVcIjtcclxuICAgIGVsc2UgdGhpcy5fc3RhdGUgPSBcIklnbm9yZTFcIlxyXG4gIH1cclxufTtcclxuQ3NzVG9rZW5pemVyLnByb3RvdHlwZS5JbkNvbnRlbnQgPSBmdW5jdGlvbihjKSB7XHJcbiAgaWYgKGMgPT0gJ30nKSB7XHJcbiAgICB0aGlzLl9jb250ZW50ID0gdGhpcy5fYnVmZmVyLnN1YnN0cmluZyh0aGlzLl9zZWN0aW9uU3RhcnQsIHRoaXMuX2luZGV4KTtcclxuICAgIGZvciAobGV0IGl0ZW0gb2YgdGhpcy5fbGlzdClcclxuICAgICAgdGhpcy5yZXNbaXRlbV0gPSAodGhpcy5yZXNbaXRlbV0gfHwgJycpICsgdGhpcy5fY29udGVudDtcclxuICAgIHRoaXMuX2xpc3QgPSBbXTtcclxuICAgIHRoaXMuX2NvbW1hID0gZmFsc2U7XHJcbiAgICB0aGlzLl9zdGF0ZSA9IFwiU1BBQ0VcIjtcclxuICB9XHJcbn07XHJcbkNzc1Rva2VuaXplci5wcm90b3R5cGUuSWdub3JlTmFtZSA9IGZ1bmN0aW9uKGMpIHtcclxuICBpZiAoYyA9PSAnLCcpIHtcclxuICAgIHRoaXMuX3NlY3Rpb25TdGFydCA9IHRoaXMuX2luZGV4ICsgMTtcclxuICAgIHRoaXMuX3N0YXRlID0gXCJJbk5hbWVcIjtcclxuICB9IGVsc2UgaWYgKGMgPT0gJ3snKSB7XHJcbiAgICB0aGlzLl9zZWN0aW9uU3RhcnQgPSB0aGlzLl9pbmRleCArIDE7XHJcbiAgICB0aGlzLl9zdGF0ZSA9IFwiSW5Db250ZW50XCI7XHJcbiAgfVxyXG59XHJcbkNzc1Rva2VuaXplci5wcm90b3R5cGUuSWdub3JlMSA9IGZ1bmN0aW9uKGMpIHtcclxuICBpZiAoYyA9PSAnOycpIHtcclxuICAgIHRoaXMuX3N0YXRlID0gXCJTUEFDRVwiO1xyXG4gICAgdGhpcy5fc2VjdGlvblN0YXJ0ID0gdGhpcy5faW5kZXggKyAxO1xyXG4gIH0gZWxzZSBpZiAoYyA9PSAneycpIHRoaXMuX3N0YXRlID0gXCJJZ25vcmUyXCI7XHJcbn07XHJcbkNzc1Rva2VuaXplci5wcm90b3R5cGUuSWdub3JlMiA9IGZ1bmN0aW9uKGMpIHtcclxuICBpZiAoYyA9PSAnfScpIHtcclxuICAgIHRoaXMuX3N0YXRlID0gXCJTUEFDRVwiO1xyXG4gICAgdGhpcy5fc2VjdGlvblN0YXJ0ID0gdGhpcy5faW5kZXggKyAxO1xyXG4gIH0gZWxzZSBpZiAoYyA9PSAneycpIHRoaXMuX3N0YXRlID0gXCJJZ25vcmUzXCI7XHJcbn07XHJcbkNzc1Rva2VuaXplci5wcm90b3R5cGUuSWdub3JlMyA9IGZ1bmN0aW9uKGMpIHtcclxuICBpZiAoYyA9PSAnfScpIHRoaXMuX3N0YXRlID0gXCJJZ25vcmUyXCI7XHJcbn07XHJcbkNzc1Rva2VuaXplci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbigpIHtcclxuICBmb3IgKDsgdGhpcy5faW5kZXggPCB0aGlzLl9idWZmZXIubGVuZ3RoOyB0aGlzLl9pbmRleCsrKVxyXG4gICAgdGhpc1t0aGlzLl9zdGF0ZV0odGhpcy5fYnVmZmVyW3RoaXMuX2luZGV4XSk7XHJcbiAgcmV0dXJuIHRoaXMucmVzO1xyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IENzc1Rva2VuaXplcjsiXX0=