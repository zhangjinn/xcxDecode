'use strict';

// Parser/trees/trees.js
Component({
  properties: {
    nodes: {
      type: Array,
      value: []
    },
    controls: {
      type: Object,
      value: {}
    }
  },
  methods: {
    //冒泡事件
    playEvent: function playEvent(e) {
      this.triggerEvent('play', e.currentTarget.dataset.id, {
        bubbles: true,
        composed: true
      });
    },
    previewEvent: function previewEvent(e) {
      if (!e.target.dataset.hasOwnProperty('ignore')) {
        this.triggerEvent('preview', e.currentTarget.dataset.src, {
          bubbles: true,
          composed: true
        });
      }
    },
    tapEvent: function tapEvent(e) {
      this.triggerEvent('linkpress', e.currentTarget.dataset.href, {
        bubbles: true,
        composed: true
      });
    },
    errorEvent: function errorEvent(e) {
      //尝试加载其他源
      if (!this.data.controls[e.currentTarget.dataset.id] && e.currentTarget.dataset.source.length > 1) {
        this.data.controls[e.currentTarget.dataset.id] = {
          play: false,
          index: 1
        };
      } else if (this.data.controls[e.currentTarget.dataset.id] && e.currentTarget.dataset.source.length > this.data.controls[e.currentTarget.dataset.id].index + 1) {
        this.data.controls[e.currentTarget.dataset.id].index++;
      }
      this.setData({
        controls: this.data.controls
      });
      this.triggerEvent('error', {
        target: e.currentTarget,
        message: e.detail.errMsg
      }, {
        bubbles: true,
        composed: true
      });
    },

    //内部方法：加载视频
    _loadVideo: function _loadVideo(e) {
      this.data.controls[e.currentTarget.dataset.id] = {
        play: true,
        index: 0
      };
      this.setData({
        controls: this.data.controls
      });
    }
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyZWVzLmpzIl0sIm5hbWVzIjpbIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJub2RlcyIsInR5cGUiLCJBcnJheSIsInZhbHVlIiwiY29udHJvbHMiLCJPYmplY3QiLCJtZXRob2RzIiwicGxheUV2ZW50IiwiZSIsInRyaWdnZXJFdmVudCIsImN1cnJlbnRUYXJnZXQiLCJkYXRhc2V0IiwiaWQiLCJidWJibGVzIiwiY29tcG9zZWQiLCJwcmV2aWV3RXZlbnQiLCJ0YXJnZXQiLCJoYXNPd25Qcm9wZXJ0eSIsInNyYyIsInRhcEV2ZW50IiwiaHJlZiIsImVycm9yRXZlbnQiLCJkYXRhIiwic291cmNlIiwibGVuZ3RoIiwicGxheSIsImluZGV4Iiwic2V0RGF0YSIsIm1lc3NhZ2UiLCJkZXRhaWwiLCJlcnJNc2ciLCJfbG9hZFZpZGVvIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0FBLFVBQVU7QUFDUkMsY0FBWTtBQUNWQyxXQUFPO0FBQ0xDLFlBQU1DLEtBREQ7QUFFTEMsYUFBTztBQUZGLEtBREc7QUFLVkMsY0FBVTtBQUNSSCxZQUFNSSxNQURFO0FBRVJGLGFBQU87QUFGQztBQUxBLEdBREo7QUFXUkcsV0FBUztBQUNQO0FBQ0FDLGFBRk8scUJBRUdDLENBRkgsRUFFTTtBQUNYLFdBQUtDLFlBQUwsQ0FBa0IsTUFBbEIsRUFBMEJELEVBQUVFLGFBQUYsQ0FBZ0JDLE9BQWhCLENBQXdCQyxFQUFsRCxFQUFzRDtBQUNwREMsaUJBQVMsSUFEMkM7QUFFcERDLGtCQUFVO0FBRjBDLE9BQXREO0FBSUQsS0FQTTtBQVFQQyxnQkFSTyx3QkFRTVAsQ0FSTixFQVFTO0FBQ2QsVUFBSSxDQUFDQSxFQUFFUSxNQUFGLENBQVNMLE9BQVQsQ0FBaUJNLGNBQWpCLENBQWdDLFFBQWhDLENBQUwsRUFBZ0Q7QUFDOUMsYUFBS1IsWUFBTCxDQUFrQixTQUFsQixFQUE2QkQsRUFBRUUsYUFBRixDQUFnQkMsT0FBaEIsQ0FBd0JPLEdBQXJELEVBQTBEO0FBQ3hETCxtQkFBUyxJQUQrQztBQUV4REMsb0JBQVU7QUFGOEMsU0FBMUQ7QUFJRDtBQUNGLEtBZk07QUFnQlBLLFlBaEJPLG9CQWdCRVgsQ0FoQkYsRUFnQks7QUFDVixXQUFLQyxZQUFMLENBQWtCLFdBQWxCLEVBQStCRCxFQUFFRSxhQUFGLENBQWdCQyxPQUFoQixDQUF3QlMsSUFBdkQsRUFBNkQ7QUFDM0RQLGlCQUFTLElBRGtEO0FBRTNEQyxrQkFBVTtBQUZpRCxPQUE3RDtBQUlELEtBckJNO0FBc0JQTyxjQXRCTyxzQkFzQkliLENBdEJKLEVBc0JPO0FBQ1o7QUFDQSxVQUFJLENBQUMsS0FBS2MsSUFBTCxDQUFVbEIsUUFBVixDQUFtQkksRUFBRUUsYUFBRixDQUFnQkMsT0FBaEIsQ0FBd0JDLEVBQTNDLENBQUQsSUFBbURKLEVBQUVFLGFBQUYsQ0FBZ0JDLE9BQWhCLENBQXdCWSxNQUF4QixDQUErQkMsTUFBL0IsR0FBd0MsQ0FBL0YsRUFBa0c7QUFDaEcsYUFBS0YsSUFBTCxDQUFVbEIsUUFBVixDQUFtQkksRUFBRUUsYUFBRixDQUFnQkMsT0FBaEIsQ0FBd0JDLEVBQTNDLElBQWlEO0FBQy9DYSxnQkFBTSxLQUR5QztBQUUvQ0MsaUJBQU87QUFGd0MsU0FBakQ7QUFJRCxPQUxELE1BS08sSUFBSSxLQUFLSixJQUFMLENBQVVsQixRQUFWLENBQW1CSSxFQUFFRSxhQUFGLENBQWdCQyxPQUFoQixDQUF3QkMsRUFBM0MsS0FBa0RKLEVBQUVFLGFBQUYsQ0FBZ0JDLE9BQWhCLENBQXdCWSxNQUF4QixDQUErQkMsTUFBL0IsR0FBeUMsS0FBS0YsSUFBTCxDQUFVbEIsUUFBVixDQUFtQkksRUFBRUUsYUFBRixDQUFnQkMsT0FBaEIsQ0FBd0JDLEVBQTNDLEVBQStDYyxLQUEvQyxHQUF1RCxDQUF0SixFQUEwSjtBQUMvSixhQUFLSixJQUFMLENBQVVsQixRQUFWLENBQW1CSSxFQUFFRSxhQUFGLENBQWdCQyxPQUFoQixDQUF3QkMsRUFBM0MsRUFBK0NjLEtBQS9DO0FBQ0Q7QUFDRCxXQUFLQyxPQUFMLENBQWE7QUFDWHZCLGtCQUFVLEtBQUtrQixJQUFMLENBQVVsQjtBQURULE9BQWI7QUFHQSxXQUFLSyxZQUFMLENBQWtCLE9BQWxCLEVBQTJCO0FBQ3pCTyxnQkFBUVIsRUFBRUUsYUFEZTtBQUV6QmtCLGlCQUFTcEIsRUFBRXFCLE1BQUYsQ0FBU0M7QUFGTyxPQUEzQixFQUdHO0FBQ0RqQixpQkFBUyxJQURSO0FBRURDLGtCQUFVO0FBRlQsT0FISDtBQU9ELEtBMUNNOztBQTJDUDtBQUNBaUIsY0E1Q08sc0JBNENJdkIsQ0E1Q0osRUE0Q087QUFDWixXQUFLYyxJQUFMLENBQVVsQixRQUFWLENBQW1CSSxFQUFFRSxhQUFGLENBQWdCQyxPQUFoQixDQUF3QkMsRUFBM0MsSUFBaUQ7QUFDL0NhLGNBQU0sSUFEeUM7QUFFL0NDLGVBQU87QUFGd0MsT0FBakQ7QUFJQSxXQUFLQyxPQUFMLENBQWE7QUFDWHZCLGtCQUFVLEtBQUtrQixJQUFMLENBQVVsQjtBQURULE9BQWI7QUFHRDtBQXBETTtBQVhELENBQVYiLCJmaWxlIjoidHJlZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBQYXJzZXIvdHJlZXMvdHJlZXMuanNcbkNvbXBvbmVudCh7XG4gIHByb3BlcnRpZXM6IHtcbiAgICBub2Rlczoge1xuICAgICAgdHlwZTogQXJyYXksXG4gICAgICB2YWx1ZTogW11cbiAgICB9LFxuICAgIGNvbnRyb2xzOiB7XG4gICAgICB0eXBlOiBPYmplY3QsXG4gICAgICB2YWx1ZToge31cbiAgICB9XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICAvL+WGkuazoeS6i+S7tlxuICAgIHBsYXlFdmVudChlKSB7XG4gICAgICB0aGlzLnRyaWdnZXJFdmVudCgncGxheScsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmlkLCB7XG4gICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgIGNvbXBvc2VkOiB0cnVlXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHByZXZpZXdFdmVudChlKSB7XG4gICAgICBpZiAoIWUudGFyZ2V0LmRhdGFzZXQuaGFzT3duUHJvcGVydHkoJ2lnbm9yZScpKSB7XG4gICAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdwcmV2aWV3JywgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuc3JjLCB7XG4gICAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgICBjb21wb3NlZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHRhcEV2ZW50KGUpIHtcbiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdsaW5rcHJlc3MnLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5ocmVmLCB7XG4gICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgIGNvbXBvc2VkOiB0cnVlXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGVycm9yRXZlbnQoZSkge1xuICAgICAgLy/lsJ3or5XliqDovb3lhbbku5bmupBcbiAgICAgIGlmICghdGhpcy5kYXRhLmNvbnRyb2xzW2UuY3VycmVudFRhcmdldC5kYXRhc2V0LmlkXSAmJiBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5zb3VyY2UubGVuZ3RoID4gMSkge1xuICAgICAgICB0aGlzLmRhdGEuY29udHJvbHNbZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaWRdID0ge1xuICAgICAgICAgIHBsYXk6IGZhbHNlLFxuICAgICAgICAgIGluZGV4OiAxXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhLmNvbnRyb2xzW2UuY3VycmVudFRhcmdldC5kYXRhc2V0LmlkXSAmJiBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5zb3VyY2UubGVuZ3RoID4gKHRoaXMuZGF0YS5jb250cm9sc1tlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pZF0uaW5kZXggKyAxKSkge1xuICAgICAgICB0aGlzLmRhdGEuY29udHJvbHNbZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaWRdLmluZGV4Kys7XG4gICAgICB9XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBjb250cm9sczogdGhpcy5kYXRhLmNvbnRyb2xzXG4gICAgICB9KVxuICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Vycm9yJywge1xuICAgICAgICB0YXJnZXQ6IGUuY3VycmVudFRhcmdldCxcbiAgICAgICAgbWVzc2FnZTogZS5kZXRhaWwuZXJyTXNnXG4gICAgICB9LCB7XG4gICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgIGNvbXBvc2VkOiB0cnVlXG4gICAgICB9KTtcbiAgICB9LFxuICAgIC8v5YaF6YOo5pa55rOV77ya5Yqg6L296KeG6aKRXG4gICAgX2xvYWRWaWRlbyhlKSB7XG4gICAgICB0aGlzLmRhdGEuY29udHJvbHNbZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaWRdID0ge1xuICAgICAgICBwbGF5OiB0cnVlLFxuICAgICAgICBpbmRleDogMFxuICAgICAgfVxuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgY29udHJvbHM6IHRoaXMuZGF0YS5jb250cm9sc1xuICAgICAgfSlcbiAgICB9LFxuICB9XG59KSJdfQ==